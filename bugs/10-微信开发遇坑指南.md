## 微信开发遇坑指南

### 分享相关

* 微信分享失败：链接协议问题，避免使用 http 协议 或直接 `//`。
* 微信分享失败：微信聊天窗口直接发送的链接（即显示为链接，而非卡片形式），无法配置分享信息。[详情](https://developers.weixin.qq.com/community/develop/doc/0006a8ada0cf7008afcd2c38951000)
* 微信分享失败：签名接口调用失败，可能是公众号 id 不对，或者公众号未在【JS 接口安全域名】中配置当前页面的域名。

相关扩展：

* APP 内分享失败：是因为 lazyDataCb 字段传了空函数。lazyDataCb 字段可以不传，但如果传了函数，必需要有返回值。
* APP 内，IOS 机型无法唤起 QQ 分享：链接中带了中文字符。
* 小程序分享：不传图处，默认使用页面快照。

### 授权相关

* 测试环境授权，提示用户先关注公众号：这是测试公众号的限制，线上没有此问题。

* 当开发者在网页中在**不规范**使用发起 snsapi_userinfo 网页授权时，微信将默认打开网页**快照页模式**进行基础浏览。[微信网页授权能力调整公告](https://developers.weixin.qq.com/community/minihome/doc/000c2c34068880629ced91a2f56001)

  常见的微信网页授权不规范使用案例：

  * **强制登录：**在用户打开网页时立即要求用户授权，用户拒绝后无法使用网页提供的服务；
  * **违规收集个人信息：**未在网页提前告知使用个人信息的目的、方式和范围；
  * **非必要收集：**非必要获取用户信息的网页，如文章、视频等，要求用户在浏览内容前登录；
  * **差别对待微信用户：**同样的网页在浏览器内可以无需登录直接访问，在微信内却要求用户先登录才可访问。

### 公众号相关

* 业务域名：设置后，在微信内访问该域名下页面时，不会被重新排版。用户在该域名上进行输入时，不出现安全提示，比如提示：防诈骗盗号，请勿xxx。
* JS接口安全域名：设置后，公众号开发者可在该域名下调用微信开放的 JS 接口。**域名配置包含其子域名。**
* 网页授权域名：用户在网页授权页同意授权给公众号后，微信会将授权数据传给一个回调页面，回调页面需在此域名下，以确保安全可靠。

### 微信平台跳转

* 公众号跳转小程序： [公众号H5页面跳转小程序？](https://developers.weixin.qq.com/community/develop/doc/000a0286c782588627ec7b56d56800)、[微信公众号跳转到小程序的几种方式](https://www.jianshu.com/p/4f52ee91c813)、[微信公众号跳转到小程序的几种方式](https://qz.fkw.com/news/23035.html)。
* 公众号跳转视频号：公众号无法直接跳转到视频号，目前子菜单支持的是小程序以及链接。如果对方有链接可以链接到视频号，那就可以使用链接来跳转。[想在公众号中加一个链接，跳转到别人的视频号，是否可以？](https://developers.weixin.qq.com/community/develop/doc/000404c3c3063084306db769d5bc00)、[公众号跳转视频号可以吗？](https://developers.weixin.qq.com/community/develop/doc/000204bb9f06e8f701bd6615558400)。

[微信小程序、微信公众号、H5之间相互跳转](https://blog.51cto.com/u_15127573/2764170)

### 二维别识别

[小程序中如何长按识别图片中二维码跳转？](https://developers.weixin.qq.com/community/develop/doc/000060d4ae0c1090f13c9c5f951c00)

[#小程序 小程序和公众号内长按识别哪些码是有效的](https://developers.weixin.qq.com/community/develop/article/doc/00008e4f3bc538998bfb344ec56413)

[小程序已支持长按识别二维码](https://developers.weixin.qq.com/community/develop/article/doc/00046045ea4f28f1679d6401950813)



